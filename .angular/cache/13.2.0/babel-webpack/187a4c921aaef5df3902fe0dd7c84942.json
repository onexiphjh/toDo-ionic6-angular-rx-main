{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/storage-angular\"; //new \n\nexport let TodoService = /*#__PURE__*/(() => {\n  class TodoService {\n    constructor(storage) {\n      this.storage = storage;\n      this.init();\n    }\n\n    generateKey() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let key = `todo${parseInt(`${Math.random() * 100}`)}`;\n        let ret = yield this.storage.get(key);\n\n        while (ret) {\n          key = `todo${parseInt(`${Math.random() * 100}`)}`;\n          ret = yield this.storage.get(key);\n        }\n\n        return key;\n      });\n    }\n\n    read() {\n      return __awaiter(this, void 0, void 0, function* () {\n        let todos = [];\n        yield this.storage.forEach((v, key, i) => {\n          if (key.startsWith(\"todo\")) {\n            todos.push(v);\n          }\n        });\n        return todos;\n      });\n    }\n\n    create(key, todo) {\n      return __awaiter(this, void 0, void 0, function* () {\n        console.log(\"Creating todo: \", todo);\n        return yield this.storage.set(key, todo);\n      });\n    }\n\n    update(todo) {\n      return __awaiter(this, void 0, void 0, function* () {\n        return yield this.storage.set(todo.key, todo);\n      });\n    }\n\n    delete(key) {\n      return __awaiter(this, void 0, void 0, function* () {\n        return yield this.storage.remove(key);\n      });\n    } //OLD 2 del\n    //TODO\n\n\n    filterItems(searchTerm) {\n      let tasks = [];\n      this.storage.forEach((key, value, index) => {\n        tasks.push({\n          key: value,\n          value: key\n        });\n      });\n      return tasks;\n    }\n\n    getAllTasks() {\n      let tasks = [];\n      this.storage.forEach((key, value, index) => {\n        tasks.push({\n          key: value,\n          value: key\n        });\n      });\n      return tasks;\n    } //TODO\n\n\n    getDateFilter(dateLimit) {\n      /**\n       *  A slow > https://jsmobiledev.com/article/searchbar-firebase/\n       *  B https://www.joshmorony.com/high-performance-list-filtering-in-ionic-2/\n       *     return this.storage.filter(item => {\n        return item.title.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1;\n      });\n       */\n      let tasks = [];\n      this.storage.forEach((key, value, index) => {\n        //    transform(value: string) {\n\n        /*\n          var datePipe = new DatePipe(\"en-US\");\n          var dateLimitFilter = datePipe.transform(value, 'yyyy-MM-dd');\n               let dateLimitFilter =this.datepipe.transform(dateLimit, 'yyyy-MM-dd');\n               console.log(\"|SEARCH| : \"+dateLimitFilter+\" \"+value);\n               dateLimit.getFullYear\n        */\n        let dateLimitFilter = dateLimit.getFullYear() + \"\" + dateLimit.getMonth() + \"\" + dateLimit.getDay();\n        console.log(\"|SEARCH| : \" + dateLimitFilter + \" \" + value);\n\n        if (value.toLowerCase().indexOf(dateLimitFilter) > -1) {\n          tasks.push({\n            key: value,\n            value: key\n          });\n        }\n      });\n      return tasks;\n    } //TODO\n\n\n    getSearchFilter(searchTerm) {\n      let tasks = [];\n      this.storage.forEach((key, value, index) => {\n        //item.title.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1\n        //    console.log(\"|SEARCH| : \"+searchTerm+\" \"+value);\n        if (value.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1) {\n          tasks.push({\n            key: value,\n            value: key\n          });\n        }\n      });\n      return tasks;\n    }\n\n  }\n\n  TodoService.ɵfac = function TodoService_Factory(t) {\n    return new (t || TodoService)(i0.ɵɵinject(i1.Storage));\n  };\n\n  TodoService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: TodoService,\n    factory: TodoService.ɵfac,\n    providedIn: \"root\"\n  });\n  return TodoService;\n})();","map":null,"metadata":{},"sourceType":"module"}